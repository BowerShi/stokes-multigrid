function [U1,V1,P1]=cal_A(U,V,P,N)%多重网格底层求真解
A=zeros(2*N*(N-1),2*N*(N-1));
B=zeros(2*N*(N-1),N^2);
h=1/N;
for j=2:N-1
    for i=2:N
        A((j-1)*(N-1)+i-1,(j)*(N-1)+i-1)=-1/(h^2);
        A((j-1)*(N-1)+i-1,(j-2)*(N-1)+i-1)=-1/(h^2);
        if i~=N
            A((j-1)*(N-1)+i-1,(j-1)*(N-1)+i)=-1/(h^2);
        end
        if i~=2
            A((j-1)*(N-1)+i-1,(j-1)*(N-1)+i-2)=-1/(h^2);
        end
        A((j-1)*(N-1)+i-1,(j-1)*(N-1)+i-1)=4/(h^2);
    B((j-1)*(N-1)+i-1,(j-1)*N+i)=1/h;
    B((j-1)*(N-1)+i-1,(j-1)*N+i-1)=-1/h;
    end
end
for i=2:N
    j=1;
    A((j-1)*(N-1)+i-1,(j)*(N-1)+i-1)=-1/(h^2);
    if i~=N
        A((j-1)*(N-1)+i-1,(j-1)*(N-1)+i)=-1/(h^2);
    end
    if i~=2
        A((j-1)*(N-1)+i-1,(j-1)*(N-1)+i-2)=-1/(h^2);
    end
    A((j-1)*(N-1)+i-1,(j-1)*(N-1)+i-1)=3/(h^2);
 
    B((j-1)*(N-1)+i-1,(j-1)*N+i)=1/h;
    B((j-1)*(N-1)+i-1,(j-1)*N+i-1)=-1/h;
   

    j=N;
    A((j-1)*(N-1)+i-1,(j-2)*(N-1)+i-1)=-1/(h^2);
    if i~=N
        A((j-1)*(N-1)+i-1,(j-1)*(N-1)+i)=-1/(h^2);
    end
    if i~=2
        A((j-1)*(N-1)+i-1,(j-1)*(N-1)+i-2)=-1/(h^2);
    end
    A((j-1)*(N-1)+i-1,(j-1)*(N-1)+i-1)=3/(h^2);
   
    B((j-1)*(N-1)+i-1,(j-1)*N+i)=1/h;
    B((j-1)*(N-1)+i-1,(j-1)*N+i-1)=-1/h;
  
end

for i=2:N-1
    for j=2:N
        A((N-1)*N+(i-1)*(N-1)+j-1,(N-1)*N+(i-1)*(N-1)+j-1)=4/(h^2);
        A((N-1)*N+(i-1)*(N-1)+j-1,(N-1)*N+(i)*(N-1)+j-1)=-1/(h^2);
        A((N-1)*N+(i-1)*(N-1)+j-1,(N-1)*N+(i-2)*(N-1)+j-1)=-1/(h^2);
        if j~=N
            A((N-1)*N+(i-1)*(N-1)+j-1,(N-1)*N+(i-1)*(N-1)+j)=-1/(h^2);
        end
        if j~=2
            A((N-1)*N+(i-1)*(N-1)+j-1,(N-1)*N+(i-1)*(N-1)+j-2)=-1/(h^2);
        end
    B((N-1)*N+(i-1)*(N-1)+j-1,(j-1)*N+i)=1/h;
    B((N-1)*N+(i-1)*(N-1)+j-1,(j-2)*N+i)=-1/h;
    end   
end
for j=2:N
    i=1;
        A((N-1)*N+(i-1)*(N-1)+j-1,(N-1)*N+(i-1)*(N-1)+j-1)=3/(h^2);
        A((N-1)*N+(i-1)*(N-1)+j-1,(N-1)*N+(i)*(N-1)+j-1)=-1/(h^2);
        if j~=N
            A((N-1)*N+(i-1)*(N-1)+j-1,(N-1)*N+(i-1)*(N-1)+j)=-1/(h^2);
        end
        if j~=2
            A((N-1)*N+(i-1)*(N-1)+j-1,(N-1)*N+(i-1)*(N-1)+j-2)=-1/(h^2);
        end

    B((N-1)*N+(i-1)*(N-1)+j-1,(j-1)*N+i)=1/h;
    B((N-1)*N+(i-1)*(N-1)+j-1,(j-2)*N+i)=-1/h;
   
    i=N;
        A((N-1)*N+(i-1)*(N-1)+j-1,(N-1)*N+(i-1)*(N-1)+j-1)=3/(h^2);
        A((N-1)*N+(i-1)*(N-1)+j-1,(N-1)*N+(i-2)*(N-1)+j-1)=-1/(h^2);
        if j~=N
            A((N-1)*N+(i-1)*(N-1)+j-1,(N-1)*N+(i-1)*(N-1)+j)=-1/(h^2);
        end
        if j~=2
            A((N-1)*N+(i-1)*(N-1)+j-1,(N-1)*N+(i-1)*(N-1)+j-2)=-1/(h^2);
        end

    B((N-1)*N+(i-1)*(N-1)+j-1,(j-1)*N+i)=1/h;
    B((N-1)*N+(i-1)*(N-1)+j-1,(j-2)*N+i)=-1/h;
    
end

H=[A,B;B',0*(B'*B);zeros(1,2*N*(N-1)+N^2-1),1];
b1=zeros(2*N*(N-1)+N^2+1,1);
b1(2*N*(N-1)+N^2+1)=1;
for i=2:N
    for j=1:N
        b1((j-1)*(N-1)+i-1)=U(i,j);
    end
end
for j=2:N
    for i=1:N
        b1(N*(N-1)+(i-1)*(N-1)+j-1)=V(i,j);
    end
end
x=H'*H\H'*b1;
U1=0*U;
V1=0*V;
P1=0*P;
for i=2:N
    for j=1:N
        U1(i,j)=x((j-1)*(N-1)+i-1);
    end
end
for j=2:N
    for i=1:N
        V1(i,j)=x(N*(N-1)+(i-1)*(N-1)+j-1);
    end
end
for i=1:N
    for j=1:N
        P1(i,j)=x(2*N*(N-1)+(j-1)*(N)+i);
    end
end
end