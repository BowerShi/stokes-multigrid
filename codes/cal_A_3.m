function [U1,V1]=cal_A_3(U,V,N)%列方程计算直接计算多重网格底层真解
A=zeros(2*N*(N-1),2*N*(N-1));
h=1/N;
for j=2:N-1
    for i=2:N
        A((j-1)*(N-1)+i-1,(j)*(N-1)+i-1)=-1/(h^2);
        A((j-1)*(N-1)+i-1,(j-2)*(N-1)+i-1)=-1/(h^2);
        if i~=N
            A((j-1)*(N-1)+i-1,(j-1)*(N-1)+i)=-1/(h^2);
        end
        if i~=2
            A((j-1)*(N-1)+i-1,(j-1)*(N-1)+i-2)=-1/(h^2);
        end
        A((j-1)*(N-1)+i-1,(j-1)*(N-1)+i-1)=4/(h^2);
    end
end
for i=2:N
    j=1;
    A((j-1)*(N-1)+i-1,(j)*(N-1)+i-1)=-1/(h^2);
    if i~=N
        A((j-1)*(N-1)+i-1,(j-1)*(N-1)+i)=-1/(h^2);
    end
    if i~=2
        A((j-1)*(N-1)+i-1,(j-1)*(N-1)+i-2)=-1/(h^2);
    end
    A((j-1)*(N-1)+i-1,(j-1)*(N-1)+i-1)=3/(h^2);
    j=N;
    A((j-1)*(N-1)+i-1,(j-2)*(N-1)+i-1)=-1/(h^2);
    if i~=N
        A((j-1)*(N-1)+i-1,(j-1)*(N-1)+i)=-1/(h^2);
    end
    if i~=2
        A((j-1)*(N-1)+i-1,(j-1)*(N-1)+i-2)=-1/(h^2);
    end
    A((j-1)*(N-1)+i-1,(j-1)*(N-1)+i-1)=3/(h^2);
  
end

for i=2:N-1
    for j=2:N
        A((N-1)*N+(i-1)*(N-1)+j-1,(N-1)*N+(i-1)*(N-1)+j-1)=4/(h^2);
        A((N-1)*N+(i-1)*(N-1)+j-1,(N-1)*N+(i)*(N-1)+j-1)=-1/(h^2);
        A((N-1)*N+(i-1)*(N-1)+j-1,(N-1)*N+(i-2)*(N-1)+j-1)=-1/(h^2);
        if j~=N
            A((N-1)*N+(i-1)*(N-1)+j-1,(N-1)*N+(i-1)*(N-1)+j)=-1/(h^2);
        end
        if j~=2
            A((N-1)*N+(i-1)*(N-1)+j-1,(N-1)*N+(i-1)*(N-1)+j-2)=-1/(h^2);
        end
    end   
end
for j=2:N
    i=1;
        A((N-1)*N+(i-1)*(N-1)+j-1,(N-1)*N+(i-1)*(N-1)+j-1)=3/(h^2);
        A((N-1)*N+(i-1)*(N-1)+j-1,(N-1)*N+(i)*(N-1)+j-1)=-1/(h^2);
        if j~=N
            A((N-1)*N+(i-1)*(N-1)+j-1,(N-1)*N+(i-1)*(N-1)+j)=-1/(h^2);
        end
        if j~=2
            A((N-1)*N+(i-1)*(N-1)+j-1,(N-1)*N+(i-1)*(N-1)+j-2)=-1/(h^2);
        end
   
    i=N;
        A((N-1)*N+(i-1)*(N-1)+j-1,(N-1)*N+(i-1)*(N-1)+j-1)=3/(h^2);
        A((N-1)*N+(i-1)*(N-1)+j-1,(N-1)*N+(i-2)*(N-1)+j-1)=-1/(h^2);
        if j~=N
            A((N-1)*N+(i-1)*(N-1)+j-1,(N-1)*N+(i-1)*(N-1)+j)=-1/(h^2);
        end
        if j~=2
            A((N-1)*N+(i-1)*(N-1)+j-1,(N-1)*N+(i-1)*(N-1)+j-2)=-1/(h^2);
        end
end

b1=zeros(2*N*(N-1),1);
for i=2:N
    for j=1:N
        b1((j-1)*(N-1)+i-1)=U(i,j);
    end
end
for j=2:N
    for i=1:N
        b1(N*(N-1)+(i-1)*(N-1)+j-1)=V(i,j);
    end
end
x=A\b1;
U1=0*U;
V1=0*V;
for i=2:N
    for j=1:N
        U1(i,j)=x((j-1)*(N-1)+i-1);
    end
end
for j=2:N
    for i=1:N
        V1(i,j)=x(N*(N-1)+(i-1)*(N-1)+j-1);
    end
end
end